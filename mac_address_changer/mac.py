#mac address changer
import subprocess
import optparse
import re

def change(interface,new_mac):
	
	print("[*] changing MAC addr to "+new_mac+" for interface "+interface+" :")
	subprocess.call(["sudo","ifconfig",interface,"down"])
	subprocess.call(["sudo","ifconfig",interface,"hw","ether",new_mac])
	subprocess.call(["sudo","ifconfig",interface,"up"])


def args():
	
	parser=optparse.OptionParser()
	parser.add_option("-i","--interface",dest="interface",help="interface to change mac:")
	parser.add_option("-m","--mac",dest="new_mac",help="new mac_address:")
	(options,args)=parser.parse_args()
	if not options.interface:
		print("[-] Please give interface for changing address")
	elif not options.new_mac:
	    print("[-] Please give new mac address ")	
	return options

def get_current_mac(interface):
    ifconfig_result=subprocess.check_output(["sudo","ifconfig",interface])
    mac_address_search_result=re.search(r"\w\w:\w\w:\w\w:\w\w:\w\w:\w\w",ifconfig_result)
    if mac_address_search_result:
    	return mac_address_search_result.group(0)
    else:
    	print("!!!!! Some error while reading")
#subprocess.call("ifconfig lo down",shell=True)
#subprocess.call("ifconfig lo hw ether 00:11:22:33:44:55",shell=True)
#subprocess.call("ifconfig l0 up",shell=True)


#interface=input("interface > ")
#new_mac=input("new address > ")
(options)=args()
interface=options.interface
new_mac=options.new_mac
change(interface,new_mac)
current_mac=get_current_mac(interface)
if current_mac==new_mac:
	print("[*] MAC address succesfully changed")
	print("\n\n!!!!GIVE US FEEDBACK ->\
		@ankitkumar202.ak@gmail.com ") 
else:
    print("[-] MAC address didn't change ,for any issues report a bug at -> \
    	 https://github.com/ankit2001/pentestools.git")
